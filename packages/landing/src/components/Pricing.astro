---
const plans = [
  {
    name: 'Monthly',
    price: '3.99',
    currency: '€',
    period: '/month',
    description: 'Flexible access for individual developers.',
    features: [
      'Unlimited PR Dashboards',
      'Custom Filter Views',
      'Native Desktop Notifications',
      'GitHub & GitLab Support',
      'CI/CD Status Integration',
    ],
    cta: 'Start Monthly Plan',
    featured: false,
  },
  {
    name: 'Annual',
    price: '34.99',
    currency: '€',
    period: '/year',
    description: 'Maximum value, best performance.',
    features: [
      'All Monthly Features',
      'Priority Cloud Sync',
      'Early Beta Access',
      'VIP Priority Support',
      'Save 25% vs Monthly',
    ],
    cta: 'Start Annual Plan',
    featured: true,
    savings: 'Save 25%',
  },
];
---

<section id="pricing" class="py-32 px-6 relative">
  <div class="max-w-5xl mx-auto">
    <!-- Section Header -->
    <div class="text-center mb-20">
      <h2 class="text-4xl md:text-6xl font-black mb-6 tracking-tight text-white">
        Simple, transparent pricing.
      </h2>
      <p class="text-slate-400 text-lg max-w-xl mx-auto">
        Unlock full productivity with our pro features. Start with a 7-day free trial.
      </p>
    </div>

    <!-- Pricing Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto items-stretch">
      {plans.map((plan) => (
        <div
          class={`relative p-10 rounded-4xl transition-all duration-500 transform hover:-translate-y-2 ${
            plan.featured
              ? 'glass-card border-2 border-primary animate-pulse-border bg-gradient-to-br from-primary/5 to-accent/5 md:scale-105 z-10'
              : 'glass-card'
          }`}
        >
          {/* Badges */}
          {plan.featured && (
            <div class="absolute -top-5 left-1/2 -translate-x-1/2">
              <span class="px-6 py-2 bg-gradient-to-r from-primary to-accent text-white text-xs font-black rounded-full uppercase tracking-widest shadow-xl">
                Best Value
              </span>
            </div>
          )}

          <div class="absolute -top-4 right-8">
            <span class={`px-4 py-1.5 rounded-full text-xs font-black uppercase tracking-widest shadow-lg ${
              plan.featured
                ? 'bg-accent text-white'
                : 'bg-white text-black'
            }`}>
              7-day free trial
            </span>
          </div>

          {/* Plan Info */}
          <div class="mb-10 pt-4">
            <h3 class="text-2xl font-black text-white mb-2">{plan.name}</h3>
            <p class="text-slate-400">{plan.description}</p>
          </div>

          {/* Price */}
          <div class="mb-10">
            <div class="flex items-baseline">
              <span class="text-6xl font-black text-white">{plan.price}{plan.currency}</span>
              <span class="text-slate-500 ml-2 font-bold uppercase text-xs tracking-widest">{plan.period}</span>
            </div>
            {plan.savings && (
              <div class="mt-3">
                <span class="inline-block px-3 py-1 bg-emerald-500/20 text-emerald-400 text-xs font-black uppercase tracking-widest rounded">
                  {plan.savings}
                </span>
              </div>
            )}
          </div>

          {/* Features List */}
          <ul class="space-y-4 mb-12">
            {plan.features.map((feature) => (
              <li class="flex items-center gap-4 text-slate-300">
                <svg class={`w-5 h-5 flex-shrink-0 ${plan.featured ? 'text-accent' : 'text-primary'}`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                </svg>
                <span>{feature}</span>
              </li>
            ))}
          </ul>

          {/* CTA Button */}
          <button
            class={`w-full py-5 px-8 rounded-2xl text-center font-black text-lg transition-all duration-300 ${
              plan.featured
                ? 'bg-gradient-to-r from-primary to-accent text-white shadow-xl shadow-primary/30 hover:shadow-primary/50 hover:-translate-y-1'
                : 'glass-card border border-white/20 text-white hover:bg-white/10'
            }`}
            data-price-id={plan.name.toLowerCase()}
          >
            {plan.cta}
          </button>
        </div>
      ))}
    </div>

    {/* Trust Text */}
    <p class="text-center mt-16 text-sm text-slate-500 font-medium">
      Secure payments via LemonSqueezy. Cancel anytime during your trial.
    </p>

    {/* FAQ Section */}
    <div class="mt-24 max-w-3xl mx-auto">
      <h3 class="text-2xl font-black text-white text-center mb-12">Frequently Asked Questions</h3>

      <div class="space-y-4">
        <details class="group glass-card rounded-2xl overflow-hidden">
          <summary class="flex items-center justify-between p-6 cursor-pointer text-white font-semibold hover:bg-white/5 transition-colors">
            <span>Can I use PR Manager with private repositories?</span>
            <svg class="w-5 h-5 text-slate-400 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="px-6 pb-6 text-slate-400">
            Yes! PR Manager works with both public and private repositories on GitHub and GitLab. Your credentials are securely stored locally on your device.
          </div>
        </details>

        <details class="group glass-card rounded-2xl overflow-hidden">
          <summary class="flex items-center justify-between p-6 cursor-pointer text-white font-semibold hover:bg-white/5 transition-colors">
            <span>What happens after the free trial?</span>
            <svg class="w-5 h-5 text-slate-400 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="px-6 pb-6 text-slate-400">
            After your 7-day free trial, you'll be charged for your selected plan. You can cancel anytime before the trial ends without being charged.
          </div>
        </details>

        <details class="group glass-card rounded-2xl overflow-hidden">
          <summary class="flex items-center justify-between p-6 cursor-pointer text-white font-semibold hover:bg-white/5 transition-colors">
            <span>Do you offer refunds?</span>
            <svg class="w-5 h-5 text-slate-400 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="px-6 pb-6 text-slate-400">
            We offer a 30-day money-back guarantee. If you're not satisfied with PR Manager, contact our support team for a full refund.
          </div>
        </details>

        <details class="group glass-card rounded-2xl overflow-hidden">
          <summary class="flex items-center justify-between p-6 cursor-pointer text-white font-semibold hover:bg-white/5 transition-colors">
            <span>Can I switch between monthly and annual plans?</span>
            <svg class="w-5 h-5 text-slate-400 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="px-6 pb-6 text-slate-400">
            Yes! You can upgrade or downgrade your plan at any time. Changes will take effect at the start of your next billing cycle.
          </div>
        </details>
      </div>
    </div>
  </div>
</section>

<script>
  document.querySelectorAll('[data-price-id]').forEach((button) => {
    button.addEventListener('click', () => {
      const priceId = button.getAttribute('data-price-id');

      // Check if user is already logged in
      const token = localStorage.getItem('pr_manager_token') || localStorage.getItem('pr_manager_token');

      if (token) {
        // If logged in, go directly to checkout
        window.location.href = `/checkout?plan=${priceId}`;
      } else {
        // If not logged in, go to signup first
        window.location.href = `/signup?plan=${priceId}`;
      }
    });
  });
</script>
