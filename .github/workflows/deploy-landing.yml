name: "Deploy Landing"

on:
  workflow_call:
  workflow_dispatch:

# Queue deploys - never cancel in-progress
concurrency:
  group: deploy-landing
  cancel-in-progress: false

permissions:
  contents: read

jobs:
  deploy:
    name: "Deploy to Vercel"
    runs-on: ubuntu-latest
    steps:
      - name: "Checkout code"
        uses: actions/checkout@v4

      - name: "Setup Node.js"
        uses: actions/setup-node@v4
        with:
          node-version: "20"

      - name: "Install Vercel CLI"
        run: npm install -g vercel

      - name: "Deploy to Vercel"
        run: vercel deploy --prod --token=${{ secrets.VERCEL_TOKEN }} --yes
        working-directory: packages/landing
        env:
          VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
          VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}

      - name: "Deployment status"
        run: |
          echo "Landing page deployed successfully"
          echo "URL: https://prmanager.app"
